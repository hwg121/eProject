═══════════════════════════════════════════════════════════════
   REDIS CACHE - HƯỚNG DẪN NHANH CHO WINDOWS SERVER
═══════════════════════════════════════════════════════════════

📋 CHECKLIST CÀI ĐẶT (5 BƯỚC CHÍNH)

┌─────────────────────────────────────────────────────────────┐
│ BƯỚC 1: CÀI MEMURAI (Redis for Windows)                    │
└─────────────────────────────────────────────────────────────┘

1. Truy cập: https://www.memurai.com/get-memurai
2. Download "Memurai Developer Edition" (MIỄN PHÍ)
3. Chạy file .msi → Next → Install
4. Memurai tự động chạy như Windows Service

✅ Kiểm tra: Mở CMD/PowerShell
   memurai-cli ping
   → Nếu thấy "PONG" là OK!


┌─────────────────────────────────────────────────────────────┐
│ BƯỚC 2: CÀI PHP REDIS EXTENSION                            │
└─────────────────────────────────────────────────────────────┘

1. Kiểm tra PHP version:
   php -v
   → Ví dụ: PHP 8.2.12

2. Download php_redis.dll:
   https://pecl.php.net/package/redis
   → Chọn version 5.3.7 cho PHP 8.2
   → Download file: redis-5.3.7-8.2-ts-vs16-x64.zip
   (ts = thread-safe, nts = non-thread-safe)

3. Giải nén và copy php_redis.dll vào:
   F:\xampp\php\ext\php_redis.dll

4. Mở file php.ini:
   F:\xampp\php\php.ini
   
   Thêm dòng này (tìm phần [Extensions]):
   extension=redis

5. Restart IIS:
   iisreset

6. Kiểm tra:
   php -m | findstr redis
   → Thấy "redis" là OK!


┌─────────────────────────────────────────────────────────────┐
│ BƯỚC 3: CÀI PREDIS PACKAGE                                 │
└─────────────────────────────────────────────────────────────┘

1. Mở PowerShell/CMD, vào thư mục backend:
   cd F:\xampp\htdocs\eProject\backend

2. Cài Predis:
   composer require predis/predis

3. Đợi composer cài xong (khoảng 30-60 giây)


┌─────────────────────────────────────────────────────────────┐
│ BƯỚC 4: CẤU HÌNH LARAVEL (.env)                            │
└─────────────────────────────────────────────────────────────┘

1. Mở file .env trên server
2. Tìm và sửa dòng này:
   CACHE_STORE=database
   → Đổi thành:
   CACHE_STORE=redis

3. Thêm các dòng sau (nếu chưa có):

REDIS_CLIENT=predis
REDIS_HOST=127.0.0.1
REDIS_PASSWORD=null
REDIS_PORT=6379
REDIS_DB=0
REDIS_CACHE_DB=1

4. Save file .env


┌─────────────────────────────────────────────────────────────┐
│ BƯỚC 5: CLEAR CACHE & TEST                                 │
└─────────────────────────────────────────────────────────────┘

1. Clear cache Laravel:
   php artisan config:clear
   php artisan cache:clear
   php artisan config:cache

2. Restart IIS:
   iisreset

3. Test Redis:
   php test_redis.php

4. Nếu thấy "✅ Redis connection: SUCCESS" là XONG!


═══════════════════════════════════════════════════════════════
   TỰ ĐỘNG HÓA (CHẠY 1 LỆNH)
═══════════════════════════════════════════════════════════════

Nếu muốn tự động:
1. Mở PowerShell AS ADMINISTRATOR
2. Chạy:
   .\install_redis_windows.ps1

Script sẽ tự động làm hết!


═══════════════════════════════════════════════════════════════
   KẾT QUẢ MONG ĐỢI
═══════════════════════════════════════════════════════════════

TRƯỚC (Database Cache):
  - Cache read: 50-100ms
  - Dashboard load: 500-800ms
  - Visitor tracking: 200ms

SAU (Redis Cache):
  - Cache read: 5-10ms     (10x NHANH HƠN ⚡)
  - Dashboard load: 200-400ms (2x NHANH HƠN 🚀)
  - Visitor tracking: 50ms  (4x NHANH HƠN ⚡)
  - Database load: GIẢM 30-50%


═══════════════════════════════════════════════════════════════
   XỬ LÝ LỖI THƯỜNG GẶP
═══════════════════════════════════════════════════════════════

❌ Lỗi: "Connection refused"
   → Check Memurai service:
     services.msc → tìm "Memurai" → Start
   
❌ Lỗi: "Class 'Redis' not found"
   → PHP extension chưa cài hoặc chưa load
   → Check: php -m | findstr redis
   → Nếu không thấy → làm lại Bước 2

❌ Lỗi: "Class 'Predis\Client' not found"
   → Predis chưa cài
   → Làm lại Bước 3

❌ memurai-cli ping → "Connection refused"
   → Memurai chưa chạy
   → Start Service: Start-Service Memurai


═══════════════════════════════════════════════════════════════
   KIỂM TRA SAU KHI CÀI
═══════════════════════════════════════════════════════════════

Test 1: Memurai đang chạy
  memurai-cli ping
  → Phải thấy: PONG

Test 2: PHP Extension
  php -m | findstr redis
  → Phải thấy: redis

Test 3: Laravel kết nối Redis
  php artisan tinker
  Cache::put('test', 'OK', 60);
  Cache::get('test');
  → Phải thấy: "OK"


═══════════════════════════════════════════════════════════════
   LINK HỮU ÍCH
═══════════════════════════════════════════════════════════════

📖 Hướng dẫn đầy đủ:
   backend/REDIS_SETUP_WINDOWS.md

🔗 Download Memurai:
   https://www.memurai.com/get-memurai

🔗 Download PHP Redis:
   https://pecl.php.net/package/redis

📞 Support:
   https://docs.memurai.com/


═══════════════════════════════════════════════════════════════
   TỔNG KẾT
═══════════════════════════════════════════════════════════════

✅ Cài Memurai (5 phút)
✅ Cài PHP Extension (3 phút)
✅ Cài Predis (2 phút)
✅ Cấu hình .env (1 phút)
✅ Test (1 phút)

TỔNG THỜI GIAN: ~12 phút
KẾT QUẢ: Website NHANH HƠN 2-10 LẦN! 🚀🎉


═══════════════════════════════════════════════════════════════
Created for Green Groves Project
Last Updated: 2025-10-15
═══════════════════════════════════════════════════════════════

