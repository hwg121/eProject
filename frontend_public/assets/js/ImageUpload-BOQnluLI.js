import{j as e}from"./ui-CSNrQhPN.js";import{r}from"./react-vendor-Dr4n66tC.js";import{p as a}from"./api-CwrNSExO.js";const t=({value:t,onChange:s,onError:l,className:n="",placeholder:i="Click to upload image",accept:o="image/*",maxSize:c=10})=>{const[d,m]=r.useState(!1),[u,h]=r.useState(t||null),x=r.useRef(null);return e.jsxs("div",{className:"relative "+n,children:[e.jsx("input",{ref:x,type:"file",accept:o,onChange:e=>{var r;const t=null==(r=e.target.files)?void 0:r[0];t&&(r=>{return t=function*(){if(r.size>1048576*c)null==l||l(`File size must be less than ${c}MB`);else if(r.type.startsWith("image/")){m(!0);try{const e=new FileReader;e.onload=e=>{var r;h(null==(r=e.target)?void 0:r.result)},e.readAsDataURL(r);const t=yield a.uploadFile(r,"image");s(t.url)}catch(e){null==l||l("Failed to upload image. Please try again.")}finally{m(!1)}}else null==l||l("Please select an image file")},new Promise((r,a)=>{var s=r=>{try{n(t.next(r))}catch(e){a(e)}},l=r=>{try{n(t.throw(r))}catch(e){a(e)}},n=e=>e.done?r(e.value):Promise.resolve(e.value).then(s,l);n((t=t.apply(void 0,null)).next())});var t})(t)},className:"hidden"}),e.jsx("div",{onClick:()=>{var e;null==(e=x.current)||e.click()},className:`\n          border-2 border-dashed rounded-lg p-4 cursor-pointer transition-colors\n          ${u?"border-green-500 bg-green-50":"border-gray-300 hover:border-gray-400"}\n          ${d?"opacity-50 cursor-not-allowed":""}\n        `,children:u?e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:u,alt:"Preview",className:"w-full h-32 object-cover rounded"}),e.jsx("button",{type:"button",onClick:e=>{e.stopPropagation(),h(null),s(""),x.current&&(x.current.value="")},className:"absolute top-2 right-2 bg-red-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-sm hover:bg-red-600",children:"Ã—"})]}):e.jsx("div",{className:"text-center",children:e.jsx("div",{className:"text-gray-500 mb-2",children:d?e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-green-500"}),e.jsx("span",{className:"ml-2",children:"Uploading..."})]}):e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"mx-auto h-12 w-12 text-gray-400",stroke:"currentColor",fill:"none",viewBox:"0 0 48 48",children:e.jsx("path",{d:"M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8m-12 4h.02",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),e.jsx("p",{className:"text-sm text-gray-600 mt-2",children:i}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Max size: ",c,"MB"]})]})})})})]})};export{t as I};
